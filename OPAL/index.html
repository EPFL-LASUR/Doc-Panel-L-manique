
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../MethodesR/">
      
      
        <link rel="next" href="../fonction-helpers/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>OPAL - Documentation Panel Lémanique</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#opal" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href=".." title="Documentation Panel Lémanique" class="md-header__button md-logo" aria-label="Documentation Panel Lémanique" data-md-component="logo">
      
  <img src="../images/Logo-Panel.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation Panel Lémanique
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OPAL
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Documentation Panel Lémanique" class="md-nav__button md-logo" aria-label="Documentation Panel Lémanique" data-md-component="logo">
      
  <img src="../images/Logo-Panel.png" alt="logo">

    </a>
    Documentation Panel Lémanique
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../MethodesR/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    R
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    OPAL
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    OPAL
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    <span class="md-ellipsis">
      Login
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acces-aux-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      Accès aux données
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accès aux données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valeurs" class="md-nav__link">
    <span class="md-ellipsis">
      Valeurs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tables-et-vues" class="md-nav__link">
    <span class="md-ellipsis">
      Tables et Vues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dictionnaires" class="md-nav__link">
    <span class="md-ellipsis">
      Dictionnaires
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fonction-helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Package panlemhelpers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contact/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#login" class="md-nav__link">
    <span class="md-ellipsis">
      Login
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acces-aux-donnees" class="md-nav__link">
    <span class="md-ellipsis">
      Accès aux données
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Accès aux données">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#valeurs" class="md-nav__link">
    <span class="md-ellipsis">
      Valeurs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tables-et-vues" class="md-nav__link">
    <span class="md-ellipsis">
      Tables et Vues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dictionnaires" class="md-nav__link">
    <span class="md-ellipsis">
      Dictionnaires
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="opal">OPAL</h1>
<h2 id="introduction">Introduction</h2>
<p>Les données du Panel Lémanique sont stockées sur OPAL, une application mise à disposition par OBiBa. OPAL sert à créer des référentiels de données centraux pour les études, qui intègrent sous une interface uniforme les données collectées à partir de multiples sources. Ainsi, grâce à OPAL, les études peuvent importer, valider, dériver, interroger, rapporter, analyser et exporter des données. (<a href="https://www.obiba.org/">Plus sur OBiBA</a>).</p>
<p>Afin d'accéder aux données sur OPAL depuis une interface R, il est nécessaire d'installer le package <code>opalr</code>:</p>
<pre><code class="language-r"># install from CRAN
install.packages(&quot;opalr&quot;)

# or install latest development version
remotes::install_github(&quot;obiba/opalr&quot;)

library(opalr)
</code></pre>
<p>Pour plus d'informations, la <a href="https://www.obiba.org/opalr/">documentation OPAL</a> est la <a href="https://www.r-project.org/">documentation R</a> sont à disposition.</p>
<h2 id="login">Login</h2>
<p>Une fois votre mot de passe reçu, la première connexion doit se faire sur l'interface graphique d'OPAL sous <a href="https://panel-lemanique-data.epfl.ch/">cette adresse</a>. Afin de pouvoir y accéder en R, il vous faudra générer un <em>Personal Access Token</em> (<a href="https://opaldoc.obiba.org/en/latest/web-user-guide/my-profile.html#two-factor-authentication">voir documentation OPAL</a>). Vous pouvez en créer un en allant dans <em>My Profile</em> en haut à gauche dans OPAL. N'oubliez pas de le sauvegarder quelque part, vous ne le verrez qu'une seule fois!</p>
<p>Une fois le Personal Access Token créé, vous pouvez ouvrir une nouvelle session dans RStudio, intaller le package <code>opalr</code> et vous connecter avec:</p>
<pre><code class="language-r">o &lt;- opal.login(token=&quot;votre_personal_access_token&quot;, url = &quot;https://panel-lemanique-data.epfl.ch/&quot;)
</code></pre>
<p>Une bonne pratique est également de changer votre mot de passe pour vous créer le votre. Vous pouvez le faire dans <em>My Profile</em>, avec le bouton <em>Update password</em>.</p>
<p>Une fois que vous avez fini de travailler dans OPAL, n'oubliez pas de vous déconnecter avec:</p>
<pre><code class="language-r">opal.logout(o)
</code></pre>
<h2 id="acces-aux-donnees">Accès aux données</h2>
<h3 id="valeurs">Valeurs</h3>
<p>Les données OPAL sont stockées sous forme de tables/vues. Celles-ci sont organisées en projets. Les données du Panel Lémanique sont dans le projet <em>Panel_Lemanique</em>. Pour lister les projets: <code>opal.projects(o)</code>. Plus sur la gestion de projets sous <a href="https://www.obiba.org/opalr/articles/opal-projects.html">Projets OPAL</a>.</p>
<p>Les données du Panel Lémanique sont organisées par vagues, chaque vague étant stockées dans une table. La commande pour lister les tables disponibles dans un projet est <code>opal.tables(o, "project")</code>. Une table peut-être crée avec <code>opal.table_create()</code> et supprimée avec <code>opal.table_delete()</code>. Plus sur les tables sous <a href="https://www.obiba.org/opalr/articles/opal-projects.html">Tables OPAL</a>.</p>
<p>Il existe deux manières de retirer les données d'une vague. Le tableau avec l'ensemble des données d'une vague peut être obtenu avec <code>opal.table_get(o, "project", "table")</code>. Pour retirer uniquement les valeurs pour une personne, la commande <code>opal.valueset(o, "project", "table", identifier = "CH007")</code> peut être utilisée. Pour obtenir les réponses à une seule question, les données doivent d'abord être retirées avec <code>df &lt;- opal.table_get()</code> puis les valeurs sont obtenus avec <code>df$Q42</code>.</p>
<h3 id="tables-et-vues">Tables et Vues</h3>
<p>OPAL fait une distinction entre les tables et les vues. Les tables sont des tableaux statiques et contiennent les données brutes du projet. Elles sont crées en téléchargeant des fichiers externes sur OPAL et en les transformant en tables. Plus sur les fichiers sous <a href="https://www.obiba.org/opalr/articles/opal-files.html">Files OPAL</a>.</p>
<p>Les vues sont des tableaux dynamiques. Elles sont crées à partir de tables et permettent des modifications à l'aide de la commande <code>opal.execute(o, "script")</code>, avec un script en R. Il est également possible de télécharger ce script sur OPAL et de l'exécuter ensuite avec <code>opal.execute.source(o, "path/to/script")</code>. Plus d'informations sous <a href="https://www.obiba.org/opalr/articles/opal-rsession.html">OPAL R Session</a>.</p>
<h3 id="dictionnaires">Dictionnaires</h3>
<p>L'un des principaux avantages d'OPAL est que les dictionnaires des variables peuvent être retirés très facilement. La commande pour cela est <code>dico &lt;- opal.table_dictionary_get(o, "project", "table")</code>. On obtient ainsi deux choses: tout d'abord, <code>dico$variable</code>, listant les variables (donc les en-tête des colonnes), et <code>dico$categories</code>, qui donne les différents labels pour une variable (e.g. 1: Homme, 2: Femme, 3: Non-binaire, 4: Ne souhaite pas répondre).</p>
<p>Les dictionnaires peuvent ensuite être téléchargés en format CSV. Malheureusement, les tableaux <code>variables</code> et <code>categories</code> doivent être téléchargés séparément, donnant donc deux fichiers CSV. La commande pour cela est <code>write.csv(dico$variable, "path/to/file")</code> (de même mais avec <code>dico$categories</code> pour le tableau <code>categories</code>). Il est également possible de télécharger un fichier XLSX avec deux feuilles, une pour les variables et une pour les catégories. Pour cela, le package <code>openxlsx</code> est votre ami. Plus sur les dictionnaires OPAL sous <a href="https://www.obiba.org/opalr/articles/opal-projects.html">Dictionnaires OPAL</a>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>